<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="icon" type="image/png" href="Images/chromie.png">
  <title>Chromie & The Cell Cycle Circus</title>
  <link rel="stylesheet" href="bio.css">
</head>
<body>


  <header>
    <img src="Images/chromo1.jpg" class="header-icon left-icon">
    
    <div class="header-text">
      <h1>Chromie & The Cell Cycle Circus</h1>
      <p>The Drama, The Romance, The Splitting-Up Feels!</p>
    </div>
    
    <img src="Images/chromo2.jpg" class="header-icon right-icon">

    <a href="profile.html" style="position: absolute; top: 10px; right:70px;">
      <img src="Images/profile.png" alt="Profile" style="width: 45px; height: 45px; cursor: pointer; background-color: white; border-radius: 100%;">
    </a>
    
  </header>
  
  <div class="page-wrapper">
  <section style="cursor: default;">
  <h2>CONCEPT HIGHLIGHTS: Introduce Chromie</h2>
  <p>SHORT NOTES: Chromie-approved notes for rapid replication.</p>
    <div class="slide" data-id="mitosis_notes" onclick="trackAndOpen('note', 'mitosis_notes',  'mitosis.html', true)" style="cursor: pointer;">
      <div class="chromie-dialogue">ğŸ“¸ Mitosis - "Still wondering? Let's dive into the explanation."</div>
    </div>
    <div class="slide" data-id="meiosis_notes" onclick="trackAndOpen('note', 'meiosis_notes',  'meiosis.html', true)" style="cursor: pointer;">
      <div class="chromie-dialogue">ğŸ’– Meiosis - â€œHalf the chromosomes, twice the excitement!â€</div>
    </div>
    <p>VIDEOS: Watch and replicateâ€”just like your favorite cells!</p>
    <div class="slide" data-id="mitosis" onclick="trackAndOpen('video', 'mitosis', 'https://www.youtube.com/watch?v=ofjyw7ARP1c&t=1s')" style="cursor: pointer;">
      <div class="chromie-dialogue">ğŸ“¸ Mitosis - â€œOne cell, two identical starsâ€”Chromieâ€™s mitotic magic!â€</div>
    </div>
      <div class="slide" data-id="meiosis"onclick="trackAndOpen('video', 'meiosis', 'https://www.youtube.com/watch?v=nMEyeKQClqI')" style="cursor: pointer;">
      <div class="chromie-dialogue">ğŸ’– Meiosis - â€œChromieâ€™s Guide to Cellular Choreographyâ€”watch the steps, spot the differences!â€</div>
    </div>
      <div class="slide" data-id="mitosismeiosis"onclick="trackAndOpen('video', 'mitosismeiosis', 'https://www.youtube.com/watch?v=zrKdz93WlVk')" style="cursor: pointer;">
      <div class="chromie-dialogue">ğŸ§ª Mitosis & Meiosis: Side by Side Comparison - â€œA visual split-screen breakdown that makes the differences crystal clear.â€</div>
    </div>
  </section>
  
  <section style="cursor: default;">
  <h2>COMIC TIME: Meet Chromie</h2>
    <div class="slide" data-id="chromie_intro_comic" onclick="trackAndOpen('comic', 'chromie_intro_comic', 'https://www.figma.com/proto/Z9gHOxxNHZOleKdIhn0U6h/Chromie---The-Cell-Cycle-Circus?node-id=66-01&t=N3Cm86sHX56oL0m7-1')" style="cursor: pointer;">
      <p>Chromie poses like a DNA-caped superhero on a nucleus stage.</p>
      <div class="chromie-dialogue">ğŸ§¬ "Iâ€™m Chromieâ€”your genetic VIP! 3 billion base pairs of fabulous!"</div>
    </div>
    <div class="slide" data-id="chromie_mitosis_comic" onclick="trackAndOpen('comic', 'chromie_mitosis_comic', 'https://www.figma.com/proto/Z9gHOxxNHZOleKdIhn0U6h/Chromie---The-Cell-Cycle-Circus?node-id=66-28&t=N3Cm86sHX56oL0m7-1')" style="cursor: pointer;">
      <p>Mitosis â€” Copy Paste Gone Wild: Chromie duplicates like a TikTok trendâ€”chromatid selfie time.</p>
      <div class="chromie-dialogue">ğŸ“¸ "Mitosis: Because your skin cells ghost you daily."</div>
    </div>
    <div class="slide" data-id="chromie_meiosis_comic" onclick="trackAndOpen('comic', 'chromie_meiosis_comic', 'https://www.figma.com/proto/Z9gHOxxNHZOleKdIhn0U6h/Chromie---The-Cell-Cycle-Circus?node-id=66-44&t=N3Cm86sHX56oL0m7-1')" style="cursor: pointer;">
      <p>Meiosis â€” Tinder for Chromosomes: Homologous chromosomes swipe right and cross over like a Netflix binge.</p>
      <div class="chromie-dialogue">ğŸ’– "Our genes would make such cute babiesâ€¦" </div>
    </div>
  </section>

  <section style="cursor: default;">
  <h2>GAME TIME: Mini Game Madness</h2>
    <div class="slide" data-id="matchup" onclick="trackAndOpen('game', 'matchup',  'matchup.html', true)" style="cursor: pointer;">
      <p>Chromosome Match-Up</p>
      <div class="chromie-dialogue">ğŸ«‚ "Chromie needs to find his/her partner."</div>
    </div>
    <div class="slide" data-id="maze" onclick="trackAndOpen('game', 'maze', 'maze.html', true)" style="cursor: pointer;">
      <p>Spindle Fiber Maze</p>
      <div class="chromie-dialogue">ğŸ® "Chromie needs to get energy, ATP and complete the maze." </div>
    </div>
  </section>
  
  <section>
    <h2>Ready to Test Your Chromie Knowledge?</h2>
    <button onclick="launchQuiz()" class="quiz-button">
      Fun Quiz
    </button>
    <button onclick="window.open('https://docs.google.com/forms/d/e/1FAIpQLSf7DpCSoeikEbcuXgrLPkY1UT0uqqfKfKPjR68_MwxVML5aAg/viewform?usp=header')" class="quiz-button">
      REAL Quiz
    </button>
    
  </section>

  <audio id="chromieSound" src="chromie_intro.mp3" preload="auto"></audio>

<script>
  function launchQuiz() {
  document.getElementById("chromieSound").play();
  setTimeout(() => {
    window.location.href = 'chromie_quiz.html';
  }, 800);
}
</script>
  <footer style="font-size: 1vw;">
    <center><p>ğŸ”¬ Made with curiosity and chromosomes by <strong>Chromie Crews</strong></p>
    <p style="margin-top: 1px;">
    </p>
  </footer>
</div>
</body>

  <script>
    (function(){if(!window.chatbase||window.chatbase("getState")!=="initialized"){window.chatbase=(...arguments)=>{if(!window.chatbase.q){window.chatbase.q=[]}window.chatbase.q.push(arguments)};window.chatbase=new Proxy(window.chatbase,{get(target,prop){if(prop==="q"){return target.q}return(...args)=>target(prop,...args)}})}const onLoad=function(){const script=document.createElement("script");script.src="https://www.chatbase.co/embed.min.js";script.id="STSTJwg07d9WPTV7bPW3w";script.domain="www.chatbase.co";document.body.appendChild(script)};if(document.readyState==="complete"){onLoad()}else{window.addEventListener("load",onLoad)}})();
</script>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";
  import {
    getFirestore,
    doc,
    updateDoc,
    getDoc
  } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAxVQYxGfceb_Hu4FcGFDVduFKa5atIfgE",
    authDomain: "chromiencellcyclecircus.firebaseapp.com",
    projectId: "chromiencellcyclecircus",
    storageBucket: "chromiencellcyclecircus.firebasestorage.app",
    messagingSenderId: "274813718407",
    appId: "1:274813718407:web:7724d59ced02b0de7b8d22",
    measurementId: "G-MP9JGD7VB3"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  function updateBorder(id, value) {
    const el = document.querySelector(`[data-id="${id}"]`);
    if (!el) return;
    el.classList.remove("status-true", "status-false");
    el.classList.add(value ? "status-true" : "status-false");
  }

  window.trackInteraction = async function(type, id) {
  console.log("âœ… trackInteraction called:", type, id);
  const user = auth.currentUser;
  if (!user) {
    alert("Please log in to save progress!");
    return;
  }

  const userRef = doc(db, "users", user.uid);
  const updatePayload = {
    [`${type === "note" ? "notesViewed" :
        type === "video" ? "videosWatched" :
        type === "comic" ? "comicsViewed" :
        type === "game" ? "gamesPlayed" : "interactions"}.${id}`]: true,
    [`interactions.${new Date().toISOString()}`]: { type, id }
  };

  console.log("ğŸ”¥ Update payload:", updatePayload);

  try {
    await updateDoc(userRef, updatePayload);
    updateBorder(id, true);
  } catch (e) {
    console.error("âŒ Firestore update failed:", e.code, e.message);
  }
};

window.trackAndOpen = function(type, id, url, sameTab = false) {
  if (sameTab) {
    window.location.href = url; // opens in same tab
  } else {
    window.open(url, '_blank'); // opens in new tab
  }
  trackInteraction(type, id);
};


  onAuthStateChanged(auth, async (user) => {
    if (!user) return;
    const userRef = doc(db, "users", user.uid);
    const snapshot = await getDoc(userRef);
    if (!snapshot.exists()) return;

    const data = snapshot.data();

    // ğŸ­ Guest mode alert
    if (data.isGuest) {
      alert("ğŸ­ You're logged in as a guest. Progress won't be saved permanently.");
    }

    const fields = ["gamesPlayed", "videosWatched", "comicsViewed", "notesViewed"];
    fields.forEach(field => {
      const items = data[field] || {};
      Object.entries(items).forEach(([id, value]) => {
        updateBorder(id, value);
      });
    });
  });
</script>
</html>
